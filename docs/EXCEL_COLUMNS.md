# Excel Report Column Reference

This document provides a **strict and precise definition** of all worksheets and columns generated by the AutoDBAudit Excel report. It serves as the single source of truth for the report schema.

## Data Types Legend
*   **TEXT**: Regular string data.
*   **BOOL**: Boolean options (Yes/No, Enabled/Disabled) usually with icons.
*   **STATUS**: PASS/FAIL/WARN indicators with color coding.
*   **INT**: Integer numbers.
*   **SIZE**: Data size (formatted as MB/GB).
*   **DATE**: Date/Time strings.
*   **ACTION**: Special visual indicator (‚è≥/‚úÖ). *Usually Column A*.
*   **MANUAL**: Gray background column intended for user input.

---

## 1. Cover
**Purpose**: Executive summary, audit metadata, and high-level statistics.
*Visuals*: Branding, Executive Summary Box, Statistics with Icons.

| Column | Name | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Spacer) | - | - |
| B | Icon | IMAGE | SQL Server Audit Icon. |
| C | Labels | TEXT | Metadata keys (Organization, Start Time, etc.). |
| D | Values | TEXT | Metadata values. |

---

## 2. Instances
**Purpose**: Inventory of SQL Server instances audited.
*Grouping*: Rotates colors by Server.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | Config Name | TEXT | Display name from configuration. |
| B | Server | TEXT | Connection target (hostname/IP). |
| C | Instance | TEXT | Instance name or `(Default)`. |
| D | Machine Name | TEXT | Physical machine/VM name from `SERVERPROPERTY`. |
| E | IP Address | TEXT | IP Address and Port. |
| F | Version | TEXT | SQL Server version string. |
| G | Build | TEXT | Product Level + CU + Build Number. |
| H | Version Status | STATUS | `PASS`/`WARN` based on lifecycle status. |
| I | SQL Year | TEXT | Marketing Year (e.g., "SQL 2019"). |
| J | Edition | TEXT | Edition (Enterprise/Standard/Developer/etc). |
| K | Clustered | BOOL | `‚úì`/`‚úó` Is Clustered. |
| L | HADR | BOOL | `‚úì`/`‚úó` Has Availability Groups enabled. |
| M | OS | TEXT | Operating System version. |
| N | CPU | INT | Logical CPU count. |
| O | RAM | INT | Physical Memory (GB). |
| P | Notes | MANUAL | User notes. |
| Q | Last Revised | DATE | Date of last manual revision. |

---

## 3. SA Account
**Purpose**: Audit of the `sa` account status (rename/disable checks).
*Compliance*: PASS if renamed AND disabled. WARN if one condition met. FAIL if neither.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if attention needed (non-compliant). |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Status | STATUS | `PASS`/`FAIL`/`WARN` compliance status. |
| E | Is Disabled | BOOL | `‚úì`/`‚úó` Is account disabled? |
| F | Is Renamed | BOOL | `‚úì`/`‚úó` Is account renamed (not 'sa')? |
| G | Current Name | TEXT | Current login name of `0x01` principal. |
| H | Default DB | TEXT | Default database for the account. |
| I | Review Status | STATUS | User status (Needs Review/Exception/Fixed). |
| J | Justification | MANUAL | User justification for non-compliance. |
| K | Last Reviewed | DATE | Date of review. |
| L | Notes | MANUAL | Additional notes. |

---

## 4. Configuration
**Purpose**: Audit of `sp_configure` settings against best practices.
*Compliance*: PASS if `Current` == `Required`.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if FAIL. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Setting | TEXT | Configuration option name. |
| E | Current | INT | Current run value. |
| F | Required | INT | Required value per policy. |
| G | Status | STATUS | `‚úÖ PASS` / `‚ùå FAIL`. |
| H | Risk | STATUS | `Critical`/`High`/`Medium`/`Low`. |
| I | Review Status | STATUS | User review dropdown. |
| J | Exception Reason | MANUAL | Reason for deviating from policy. |
| K | Last Reviewed | DATE | Date of review. |

---

## 5. Server Logins
**Purpose**: Review of SQL Server logins.
*Compliance*: PASS unless SQL Login has Password Policy disabled.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if non-compliant. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Login Name | TEXT | Login Name. |
| E | Login Type | TEXT | SQL Login / Windows User / Windows Group. |
| F | Enabled | BOOL | `‚úì Yes` / `‚úó No`. |
| G | Password Policy | BOOL | `‚úì Yes` / `‚úó No` (N/A for Windows). |
| H | Default Database | TEXT | Default DB. |
| I | Review Status | STATUS | User review dropdown. |
| J | Justification | MANUAL | User justifcation. |
| K | Last Reviewed | DATE | Date of review. |
| L | Notes | MANUAL | Additional notes. |

---

## 6. Sensitive Roles
**Purpose**: Audit of high-privilege Server Role memberships (sysadmin, etc).
*Compliance*: WARN if `sysadmin` member is enabled and not a known system account.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if sysadmin member needs justification. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Role | TEXT | Server Role (e.g., `sysadmin`). |
| E | Member | TEXT | Principal Name. |
| F | Member Type | TEXT | Principal Type. |
| G | Enabled | BOOL | `‚úì Yes` / `‚úó No`. |
| H | Review Status | STATUS | User review dropdown. |
| I | Justification | MANUAL | Justification for high privilege. |
| J | Last Revised | DATE | Date of review. |

---

## 7. Services
**Purpose**: Audit of SQL Server service statuses and accounts.
*Discrepancy*: Alerts on non-essential running services or virtual accounts.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if non-compliant/needs review. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Service Name | TEXT | Service Name (e.g., SQL Server Agent). |
| E | Type | TEXT | Service Type (e.g., Database Engine). |
| F | Status | STATUS | `‚úì Running` / `‚úó Stopped`. |
| G | Startup | STATUS | `‚ö° Auto` / `üîß Manual` / `‚õî Disabled`. |
| H | Service Account | TEXT | Account running the service. |
| I | Compliant | BOOL | `‚úì` / `‚úó` (based on account & type check). |
| J | Review Status | STATUS | User review dropdown. |
| K | Justification | MANUAL | Justification. |
| L | Last Reviewed | DATE | Date of review. |

---

## 8. Databases
**Purpose**: Audit of database properties (Recovery Model, Trustworthy, etc).
*Compliance*: Alerts on `TRUSTWORTHY ON` for user databases.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if `TRUSTWORTHY ON` (User DB). |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Database | TEXT | Database Name. |
| E | Owner | TEXT | Database Owner. |
| F | Recovery | STATUS | `üõ°Ô∏è Full` / `üì¶ Bulk` / `‚ö° Simple`. |
| G | State | STATUS | `‚úì Online` / `‚õî Offline` / etc. |
| H | Data (MB) | SIZE | Data file size. |
| I | Log (MB) | SIZE | Log file size. |
| J | Trustworthy | BOOL | `‚úì ON` (Bad for User DB) / `‚úó OFF`. |
| K | Review Status | STATUS | User review dropdown. |
| L | Justification | MANUAL | Justification. |
| M | Last Reviewed | DATE | Date of review. |
| N | Notes | MANUAL | Additional notes. |

---

## 9. Database Users
**Purpose**: Audit of users within databases, focusing on orphaned users and Guest.
*Compliance*: FAIL if `Guest` has access. WARN if Orphaned user found.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if Guest enabled or Orphaned found. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Database | TEXT | Database Name. |
| E | User Name | TEXT | Database User Name. |
| F | Type | TEXT | User Type. |
| G | Mapped Login | TEXT | Server Login mapped to user. |
| H | Login Status | STATUS | `‚úì Mapped` / `‚ö†Ô∏è Orphaned` / `üîß System`. |
| I | Compliant | STATUS | `‚úì` / `‚ö†Ô∏è Review` / `‚ùå GUEST`. |
| J | Review Status | STATUS | User review dropdown. |
| K | Justification | MANUAL | Justification. |
| L | Last Reviewed | DATE | Date of review. |
| M | Notes | MANUAL | Additional notes. |

---

## 10. Database Roles
**Purpose**: Audit of database role memberships (db_owner).
*Compliance*: WARN if `db_owner` member is not `dbo`.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if High Risk role assigned. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Database | TEXT | Database Name. |
| E | Role | TEXT | Role Name (e.g., `db_owner`). |
| F | Member | TEXT | Principal Name. |
| G | Member Type | TEXT | Principal Type (SQL/Windows). |
| H | Risk | STATUS | `üî¥ High` / `üü° Medium` / `üü¢ Low`. |
| I | Review Status | STATUS | User review dropdown. |
| J | Justification | MANUAL | Justification. |
| K | Last Reviewed | DATE | Date of review. |

---

## 11. Orphaned Users
**Purpose**: Consolidated view of all non-system orphaned users.
*Compliance*: All entries in this sheet need review.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` Always (since all represent issues). |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Database | TEXT | Database Name. |
| E | User Name | TEXT | User Name. |
| F | Type | TEXT | User Type. |
| G | Status | STATUS | `‚ö†Ô∏è Orphaned` / `‚úì Fixed` / `‚ùå Removed`. |
| H | Review Status | STATUS | User review dropdown. |
| I | Justification | MANUAL | Justification. |
| J | Last Revised | DATE | Date of review. |

---

## 12. Permission Grants
**Purpose**: Audit of explicit GRANT/DENY permissions.
*Compliance*: WARN on High Risk permissions (`CONTROL SERVER`, `ALTER ANY LOGIN`).

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if High Risk permission. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Scope | TEXT | `SERVER` / `DATABASE`. |
| E | Database | TEXT | Database Name (if applicable). |
| F | Grantee | TEXT | Principal Name. |
| G | Permission | TEXT | Permission Name (e.g., `CONTROL`). |
| H | State | STATUS | `‚úÖ GRANT` / `‚õî DENY` / `‚ö†Ô∏è GRANT w/ OPT`. |
| I | Entity Type | TEXT | Class Description (OBJECT, SCHEMA, etc). |
| J | Entity Name | TEXT | Name of object/schema. |
| K | Risk | STATUS | `üî¥ Risk` / `‚õî Blocked` (Deny) / `‚Äî`. |
| L | Review Status | STATUS | User review dropdown. |
| M | Justification | MANUAL | Justification. |
| N | Last Reviewed | DATE | Date of review. |
| O | Notes | MANUAL | Additional notes. |

---

## 13. Role Matrix
**Purpose**: Pivot table view of principals vs fixed roles.
*Note*: Informational view, no justification columns.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | Server | TEXT | Server Name. |
| B | Instance | TEXT | Instance Name. |
| C | Database | TEXT | Database Name. |
| D | Principal Name | TEXT | Principal Name. |
| E | Principal Type | TEXT | Type (Windows/SQL/Cert). |
| F | db_owner | BOOL | `‚úì`/`üëë YES` (if not dbo). |
| G | db_securityadmin| BOOL | `‚úì` if member. |
| H | db_accessadmin | BOOL | `‚úì` if member. |
| I | db_backupoperator| BOOL | `‚úì` if member. |
| J | db_ddladmin | BOOL | `‚úì` if member. |
| K | db_datareader | BOOL | `‚úì` if member. |
| L | db_datawriter | BOOL | `‚úì` if member. |
| M | db_denydatareader | BOOL | `‚úì` if member. |
| N | db_denydatawriter | BOOL | `‚úì` if member. |
| O | Other Roles | TEXT | Comma-separated custom roles. |
| P | Risk | STATUS | `üî¥ High` if db_owner (non-dbo). |

---

## 14. Linked Servers
**Purpose**: Audit of Linked Server configurations.
*Compliance*: FAIL if configured with static SQL credentials.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if security issue detected. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Linked Server | TEXT | Linked Server Name. |
| E | Product | TEXT | Product Name (SQL Server, Oracle, etc). |
| F | Provider | TEXT | Provider String. |
| G | Remote Login | BOOL | `‚úì User` (Mapped) / `‚úó SQL User` (Static). |
| H | RPC Out | BOOL | `‚úì` / `‚úó`. |
| I | Data Access | BOOL | `‚úì` / `‚úó`. |
| J | Status | STATUS | `‚úÖ Secure` / `‚ùå Insecure Credentials`. |
| K | Review Status | STATUS | User review dropdown. |
| L | Justification | MANUAL | Justification. |
| M | Last Reviewed | DATE | Date of review. |

---

## 15. Triggers
**Purpose**: Audit of Server and Database triggers.
*Compliance*: Server-level triggers need review. Database triggers for reference.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if SERVER-level trigger (needs review). |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Scope | TEXT | `SERVER` or `DATABASE` - trigger level. |
| E | Database | TEXT | Database name for DATABASE scope (empty for SERVER). |
| F | Trigger Name | TEXT | Trigger Name. |
| G | Event | TEXT | Event type (LOGON, DDL, DML). |
| H | Enabled | BOOL | `‚úì` / `‚úó`. |
| I | Review Status | STATUS | User review dropdown. |
| J | Justification | MANUAL | Justification for trigger existence. |
| K | Last Revised | DATE | Date of review. |

---

## 16. Backups
**Purpose**: Audit of backup history and RPO.
*Compliance*: FAIL if no backup in 7 days (Full) or 24h (Log).

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if missing backup. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Database | TEXT | Database Name. |
| E | Recovery | TEXT | Recovery Model. |
| F | Last Backup | DATE | Date of last Full Backup. |
| G | Days Since | INT | Days since last backup. |
| H | Size (MB) | SIZE | Backup Size. |
| I | Path | TEXT | Backup Path (shortened). |
| J | Status | STATUS | `‚úÖ OK` / `‚ùå Missing` / `‚ö†Ô∏è Old`. |
| K | Review Status | STATUS | User review dropdown. |
| L | Justification | MANUAL | Justification. |
| M | Last Reviewed | DATE | Date of review. |

---

## 17. Client Protocols
**Purpose**: Audit of network protocols.
*Compliance*: WARN if non-standard protocols (Named Pipes, VIA) enabled.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if discrepant protocol enabled. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Protocol | TEXT | Protocol Name (TCP/IP, Named Pipes). |
| E | Enabled | BOOL | `‚úì Yes` / `‚úó No`. |
| F | Port | TEXT | Port Number (if TCP). |
| G | Status | STATUS | `‚úÖ Compliant` / `‚ö†Ô∏è Needs Review`. |
| H | Notes | TEXT | Configuration notes. |
| I | Review Status | STATUS | User review dropdown. |
| J | Justification | MANUAL | Justification. |
| K | Last Revised | DATE | Date of review. |

---

## 18. Encryption
**Purpose**: Audit of encryption keys (SMK, DMK, TDE).
*Compliance*: Check if backed up and active.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | Server | TEXT | Server Name. |
| B | Instance | TEXT | Instance Name. |
| C | Database | TEXT | Database Name. |
| D | Key Type | TEXT | SMK / DMK / Certificate / Symmetric Key. |
| E | Key Name | TEXT | Name of the key/certificate. |
| F | Algorithm | TEXT | Encryption status/algo. |
| G | Created | DATE | Creation Date. |
| H | Backup Status | STATUS | `‚úì Backed Up` / `‚ö†Ô∏è Not Backed Up`. |
| I | Status | STATUS | `PASS` / `FAIL` / `WARN`. |
| J | Notes | MANUAL | Notes. |

---

## 19. Audit Settings
**Purpose**: Audit of SQL Audit and Server Audit Specifications.
*Compliance*: PASS if enabled and matches requirements.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | (Action) | ACTION | `‚è≥` if FAIL. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Setting | TEXT | Audit / Spec Name. |
| E | Current | TEXT | `Enabled` / `Disabled`. |
| F | Required | TEXT | `Enabled`. |
| G | Status | STATUS | `‚úÖ PASS` / `‚ùå FAIL`. |
| H | Risk | STATUS | `High` / `Medium`. |
| I | Review Status | STATUS | User review dropdown. |
| J | Exception Reason | MANUAL | Justification. |
| K | Last Reviewed | DATE | Date of review. |

---

## 20. Actions
**Purpose**: Audit trail of changes detected during sync (The Changelog).
*Visuals*: Color-coded Risk Level and Change Type.

| Col | Header | Type | Description |
| :--- | :--- | :--- | :--- |
| A | ID | INT | Incremental Action ID. |
| B | Server | TEXT | Server Name. |
| C | Instance | TEXT | Instance Name. |
| D | Category | TEXT | Finding Category (SA/Config/etc). |
| E | Finding | TEXT | Description of the finding. |
| F | Risk Level | STATUS | `Low` (Green) / `High` (Red). |
| G | Change Description | TEXT | What happened (Fixed/Regressed). |
| H | Change Type | STATUS | `‚úì Closed` (Fix) / `‚è≥ Open` (Regressed). |
| I | Detected Date | DATE | Date change was first seen. |
| J | Notes | MANUAL | User commentary. |
